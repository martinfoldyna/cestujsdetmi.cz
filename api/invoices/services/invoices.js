// 'use strict';
const {invoiceTemplate} = require("./templates/templates");

const Docxtemplater = require("docxtemplater");
const PizZip = require("pizzip");
const fs = require("fs");
const path = require("path")
const {v4} = require("uuid")
const libre = require('libreoffice-convert');
const { jsPDF } = require("jspdf/dist/jspdf.node");
const {applyPlugin} = require("jspdf-autotable/dist/jspdf.plugin.autotable")
const easyinvoice = require("easyinvoice");
const pdfmake = require("pdfmake");
const Roboto = {
  Roboto: {
    normal: 'fonts/Roboto-Regular.ttf',
    bold: 'fonts/Roboto-Medium.ttf',
    italics: 'fonts/Roboto-Italic.ttf',
    bolditalics: 'fonts/Roboto-MediumItalic.ttf'
  }
}
const fonts = {
  Courier: {
    normal: 'Courier',
    bold: 'Courier-Bold',
    italics: 'Courier-Oblique',
    bolditalics: 'Courier-BoldOblique'
  },
  Helvetica: {
    normal: 'Helvetica',
    bold: 'Helvetica-Bold',
    italics: 'Helvetica-Oblique',
    bolditalics: 'Helvetica-BoldOblique'
  },
  Times: {
    normal: 'Times-Roman',
    bold: 'Times-Bold',
    italics: 'Times-Italic',
    bolditalics: 'Times-BoldItalic'
  },
  Symbol: {
    normal: 'Symbol'
  },
  ZapfDingbats: {
    normal: 'ZapfDingbats'
  }
};
// pdfmake.addFonts(Roboto);


/**
 * `invoices` service.
 */

module.exports = {
  // exampleService: (arg1, arg2) => {
  //   return isUserOnline(arg1, arg2);
  // }
  create: async (data) => {

    // try here http://pdfmake.org/playground.html

    try {
      const printer = new pdfmake(Roboto);

      const docDefinition = await invoiceTemplate(data)

      const pdfDoc = await printer.createPdfKitDocument(docDefinition);
      pdfDoc.pipe(fs.createWriteStream(`invoice02.pdf`))
      pdfDoc.end()
      // return pdfDoc;
    } catch (err) {
      throw err
    }

  },
  createEasyInvoice: async (reqData) => {
    const today = new Date()

    const data = {
      "documentTitle": "Faktura",
      "currency": "CZK",
      "textNotation": "vat",
      "marginTop": 25,
      "marginLeft": 25,
      "marginRight": 25,
      "marginBottom": 25,
      "logo": "data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjY4IiBoZWlnaHQ9IjQ3IiB2aWV3Qm94PSIwIDAgMjY4IDQ3IiBmaWxsPSJub25lIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciPgo8cGF0aCBkPSJNMTAwLjAzMiAzMi4yNEM5OC4zMzYgMzIuMjQgOTYuOCAzMS44NzIgOTUuNDI0IDMxLjEzNkM5NC4wNjQgMzAuMzg0IDkyLjk5MiAyOS4zNTIgOTIuMjA4IDI4LjA0QzkxLjQ0IDI2LjcyOCA5MS4wNTYgMjUuMjQ4IDkxLjA1NiAyMy42QzkxLjA1NiAyMS45NTIgOTEuNDQ4IDIwLjQ3MiA5Mi4yMzIgMTkuMTZDOTMuMDE2IDE3Ljg0OCA5NC4wODggMTYuODI0IDk1LjQ0OCAxNi4wODhDOTYuODI0IDE1LjMzNiA5OC4zNiAxNC45NiAxMDAuMDU2IDE0Ljk2QzEwMS40MzIgMTQuOTYgMTAyLjY4OCAxNS4yIDEwMy44MjQgMTUuNjhDMTA0Ljk2IDE2LjE2IDEwNS45MiAxNi44NTYgMTA2LjcwNCAxNy43NjhMMTA0LjY4OCAxOS42NjRDMTAzLjQ3MiAxOC4zNTIgMTAxLjk3NiAxNy42OTYgMTAwLjIgMTcuNjk2Qzk5LjA0OCAxNy42OTYgOTguMDE2IDE3Ljk1MiA5Ny4xMDQgMTguNDY0Qzk2LjE5MiAxOC45NiA5NS40OCAxOS42NTYgOTQuOTY4IDIwLjU1MkM5NC40NTYgMjEuNDQ4IDk0LjIgMjIuNDY0IDk0LjIgMjMuNkM5NC4yIDI0LjczNiA5NC40NTYgMjUuNzUyIDk0Ljk2OCAyNi42NDhDOTUuNDggMjcuNTQ0IDk2LjE5MiAyOC4yNDggOTcuMTA0IDI4Ljc2Qzk4LjAxNiAyOS4yNTYgOTkuMDQ4IDI5LjUwNCAxMDAuMiAyOS41MDRDMTAxLjk3NiAyOS41MDQgMTAzLjQ3MiAyOC44NCAxMDQuNjg4IDI3LjUxMkwxMDYuNzA0IDI5LjQzMkMxMDUuOTIgMzAuMzQ0IDEwNC45NTIgMzEuMDQgMTAzLjggMzEuNTJDMTAyLjY2NCAzMiAxMDEuNDA4IDMyLjI0IDEwMC4wMzIgMzIuMjRaTTEyMC45ODUgMjUuNjY0QzEyMC45ODUgMjUuODcyIDEyMC45NjkgMjYuMTY4IDEyMC45MzcgMjYuNTUySDExMC44ODFDMTExLjA1NyAyNy40OTYgMTExLjUxMyAyOC4yNDggMTEyLjI0OSAyOC44MDhDMTEzLjAwMSAyOS4zNTIgMTEzLjkyOSAyOS42MjQgMTE1LjAzMyAyOS42MjRDMTE2LjQ0MSAyOS42MjQgMTE3LjYwMSAyOS4xNiAxMTguNTEzIDI4LjIzMkwxMjAuMTIxIDMwLjA4QzExOS41NDUgMzAuNzY4IDExOC44MTcgMzEuMjg4IDExNy45MzcgMzEuNjRDMTE3LjA1NyAzMS45OTIgMTE2LjA2NSAzMi4xNjggMTE0Ljk2MSAzMi4xNjhDMTEzLjU1MyAzMi4xNjggMTEyLjMxMyAzMS44ODggMTExLjI0MSAzMS4zMjhDMTEwLjE2OSAzMC43NjggMTA5LjMzNyAyOS45OTIgMTA4Ljc0NSAyOUMxMDguMTY5IDI3Ljk5MiAxMDcuODgxIDI2Ljg1NiAxMDcuODgxIDI1LjU5MkMxMDcuODgxIDI0LjM0NCAxMDguMTYxIDIzLjIyNCAxMDguNzIxIDIyLjIzMkMxMDkuMjk3IDIxLjIyNCAxMTAuMDg5IDIwLjQ0IDExMS4wOTcgMTkuODhDMTEyLjEwNSAxOS4zMiAxMTMuMjQxIDE5LjA0IDExNC41MDUgMTkuMDRDMTE1Ljc1MyAxOS4wNCAxMTYuODY1IDE5LjMyIDExNy44NDEgMTkuODhDMTE4LjgzMyAyMC40MjQgMTE5LjYwMSAyMS4yIDEyMC4xNDUgMjIuMjA4QzEyMC43MDUgMjMuMiAxMjAuOTg1IDI0LjM1MiAxMjAuOTg1IDI1LjY2NFpNMTE0LjUwNSAyMS40NEMxMTMuNTQ1IDIxLjQ0IDExMi43MjkgMjEuNzI4IDExMi4wNTcgMjIuMzA0QzExMS40MDEgMjIuODY0IDExMS4wMDEgMjMuNjE2IDExMC44NTcgMjQuNTZIMTE4LjEyOUMxMTguMDAxIDIzLjYzMiAxMTcuNjA5IDIyLjg4IDExNi45NTMgMjIuMzA0QzExNi4yOTcgMjEuNzI4IDExNS40ODEgMjEuNDQgMTE0LjUwNSAyMS40NFpNMTI3LjgyNiAzMi4xNjhDMTI2Ljc4NiAzMi4xNjggMTI1Ljc3IDMyLjAzMiAxMjQuNzc4IDMxLjc2QzEyMy43ODYgMzEuNDg4IDEyMi45OTQgMzEuMTQ0IDEyMi40MDIgMzAuNzI4TDEyMy41NTQgMjguNDQ4QzEyNC4xMyAyOC44MzIgMTI0LjgxOCAyOS4xNDQgMTI1LjYxOCAyOS4zODRDMTI2LjQzNCAyOS42MDggMTI3LjIzNCAyOS43MiAxMjguMDE4IDI5LjcyQzEyOS44MSAyOS43MiAxMzAuNzA2IDI5LjI0OCAxMzAuNzA2IDI4LjMwNEMxMzAuNzA2IDI3Ljg1NiAxMzAuNDc0IDI3LjU0NCAxMzAuMDEgMjcuMzY4QzEyOS41NjIgMjcuMTkyIDEyOC44MzQgMjcuMDI0IDEyNy44MjYgMjYuODY0QzEyNi43NyAyNi43MDQgMTI1LjkwNiAyNi41MiAxMjUuMjM0IDI2LjMxMkMxMjQuNTc4IDI2LjEwNCAxMjQuMDAyIDI1Ljc0NCAxMjMuNTA2IDI1LjIzMkMxMjMuMDI2IDI0LjcwNCAxMjIuNzg2IDIzLjk3NiAxMjIuNzg2IDIzLjA0OEMxMjIuNzg2IDIxLjgzMiAxMjMuMjkgMjAuODY0IDEyNC4yOTggMjAuMTQ0QzEyNS4zMjIgMTkuNDA4IDEyNi42OTggMTkuMDQgMTI4LjQyNiAxOS4wNEMxMjkuMzA2IDE5LjA0IDEzMC4xODYgMTkuMTQ0IDEzMS4wNjYgMTkuMzUyQzEzMS45NDYgMTkuNTQ0IDEzMi42NjYgMTkuODA4IDEzMy4yMjYgMjAuMTQ0TDEzMi4wNzQgMjIuNDI0QzEzMC45ODYgMjEuNzg0IDEyOS43NjIgMjEuNDY0IDEyOC40MDIgMjEuNDY0QzEyNy41MjIgMjEuNDY0IDEyNi44NSAyMS42IDEyNi4zODYgMjEuODcyQzEyNS45MzggMjIuMTI4IDEyNS43MTQgMjIuNDcyIDEyNS43MTQgMjIuOTA0QzEyNS43MTQgMjMuMzg0IDEyNS45NTQgMjMuNzI4IDEyNi40MzQgMjMuOTM2QzEyNi45MyAyNC4xMjggMTI3LjY5IDI0LjMxMiAxMjguNzE0IDI0LjQ4OEMxMjkuNzM4IDI0LjY0OCAxMzAuNTc4IDI0LjgzMiAxMzEuMjM0IDI1LjA0QzEzMS44OSAyNS4yNDggMTMyLjQ1IDI1LjYgMTMyLjkxNCAyNi4wOTZDMTMzLjM5NCAyNi41OTIgMTMzLjYzNCAyNy4yOTYgMTMzLjYzNCAyOC4yMDhDMTMzLjYzNCAyOS40MDggMTMzLjExNCAzMC4zNjggMTMyLjA3NCAzMS4wODhDMTMxLjAzNCAzMS44MDggMTI5LjYxOCAzMi4xNjggMTI3LjgyNiAzMi4xNjhaTTE0My45MjIgMzEuMzA0QzE0My41NyAzMS41OTIgMTQzLjEzOCAzMS44MDggMTQyLjYyNiAzMS45NTJDMTQyLjEzIDMyLjA5NiAxNDEuNjAyIDMyLjE2OCAxNDEuMDQyIDMyLjE2OEMxMzkuNjM0IDMyLjE2OCAxMzguNTQ2IDMxLjggMTM3Ljc3OCAzMS4wNjRDMTM3LjAxIDMwLjMyOCAxMzYuNjI2IDI5LjI1NiAxMzYuNjI2IDI3Ljg0OFYyMS42OEgxMzQuNTE0VjE5LjI4SDEzNi42MjZWMTYuMzUySDEzOS42MjZWMTkuMjhIMTQzLjA1OFYyMS42OEgxMzkuNjI2VjI3Ljc3NkMxMzkuNjI2IDI4LjQgMTM5Ljc3OCAyOC44OCAxNDAuMDgyIDI5LjIxNkMxNDAuMzg2IDI5LjUzNiAxNDAuODI2IDI5LjY5NiAxNDEuNDAyIDI5LjY5NkMxNDIuMDc0IDI5LjY5NiAxNDIuNjM0IDI5LjUyIDE0My4wODIgMjkuMTY4TDE0My45MjIgMzEuMzA0Wk0xNTguNzk4IDE5LjE4NFYzMkgxNTUuOTQyVjMwLjM2OEMxNTUuNDYyIDMwLjk0NCAxNTQuODYyIDMxLjM5MiAxNTQuMTQyIDMxLjcxMkMxNTMuNDIyIDMyLjAxNiAxNTIuNjQ2IDMyLjE2OCAxNTEuODE0IDMyLjE2OEMxNTAuMTAyIDMyLjE2OCAxNDguNzUgMzEuNjk2IDE0Ny43NTggMzAuNzUyQzE0Ni43ODIgMjkuNzkyIDE0Ni4yOTQgMjguMzc2IDE0Ni4yOTQgMjYuNTA0VjE5LjE4NEgxNDkuMjk0VjI2LjA5NkMxNDkuMjk0IDI3LjI0OCAxNDkuNTUgMjguMTEyIDE1MC4wNjIgMjguNjg4QzE1MC41OSAyOS4yNDggMTUxLjMzNCAyOS41MjggMTUyLjI5NCAyOS41MjhDMTUzLjM2NiAyOS41MjggMTU0LjIxNCAyOS4yIDE1NC44MzggMjguNTQ0QzE1NS40NzggMjcuODcyIDE1NS43OTggMjYuOTEyIDE1NS43OTggMjUuNjY0VjE5LjE4NEgxNTguNzk4Wk0xNjEuNDA2IDM2LjgyNEMxNjAuMTQyIDM2LjgyNCAxNTkuMTgyIDM2LjU3NiAxNTguNTI2IDM2LjA4TDE1OS4zOSAzMy44NDhDMTU5LjgzOCAzNC4xODQgMTYwLjQyMiAzNC4zNTIgMTYxLjE0MiAzNC4zNTJDMTYxLjcwMiAzNC4zNTIgMTYyLjEyNiAzNC4xNzYgMTYyLjQxNCAzMy44MjRDMTYyLjcxOCAzMy40ODggMTYyLjg3IDMyLjk4NCAxNjIuODcgMzIuMzEyVjE5LjE4NEgxNjUuODdWMzIuMjRDMTY1Ljg3IDMzLjY2NCAxNjUuNDc4IDM0Ljc4NCAxNjQuNjk0IDM1LjZDMTYzLjkxIDM2LjQxNiAxNjIuODE0IDM2LjgyNCAxNjEuNDA2IDM2LjgyNFpNMTY0LjM1OCAxNy4wNzJDMTYzLjgxNCAxNy4wNzIgMTYzLjM1OCAxNi45MDQgMTYyLjk5IDE2LjU2OEMxNjIuNjIyIDE2LjIxNiAxNjIuNDM4IDE1Ljc4NCAxNjIuNDM4IDE1LjI3MkMxNjIuNDM4IDE0Ljc2IDE2Mi42MjIgMTQuMzM2IDE2Mi45OSAxNEMxNjMuMzU4IDEzLjY0OCAxNjMuODE0IDEzLjQ3MiAxNjQuMzU4IDEzLjQ3MkMxNjQuOTAyIDEzLjQ3MiAxNjUuMzU4IDEzLjY0IDE2NS43MjYgMTMuOTc2QzE2Ni4wOTQgMTQuMjk2IDE2Ni4yNzggMTQuNzA0IDE2Ni4yNzggMTUuMkMxNjYuMjc4IDE1LjcyOCAxNjYuMDk0IDE2LjE3NiAxNjUuNzI2IDE2LjU0NEMxNjUuMzc0IDE2Ljg5NiAxNjQuOTE4IDE3LjA3MiAxNjQuMzU4IDE3LjA3MlpNMTgwLjM5NyAzMi4xNjhDMTc5LjM1NyAzMi4xNjggMTc4LjM0MSAzMi4wMzIgMTc3LjM0OSAzMS43NkMxNzYuMzU3IDMxLjQ4OCAxNzUuNTY1IDMxLjE0NCAxNzQuOTczIDMwLjcyOEwxNzYuMTI1IDI4LjQ0OEMxNzYuNzAxIDI4LjgzMiAxNzcuMzg5IDI5LjE0NCAxNzguMTg5IDI5LjM4NEMxNzkuMDA1IDI5LjYwOCAxNzkuODA1IDI5LjcyIDE4MC41ODkgMjkuNzJDMTgyLjM4MSAyOS43MiAxODMuMjc3IDI5LjI0OCAxODMuMjc3IDI4LjMwNEMxODMuMjc3IDI3Ljg1NiAxODMuMDQ1IDI3LjU0NCAxODIuNTgxIDI3LjM2OEMxODIuMTMzIDI3LjE5MiAxODEuNDA1IDI3LjAyNCAxODAuMzk3IDI2Ljg2NEMxNzkuMzQxIDI2LjcwNCAxNzguNDc3IDI2LjUyIDE3Ny44MDUgMjYuMzEyQzE3Ny4xNDkgMjYuMTA0IDE3Ni41NzMgMjUuNzQ0IDE3Ni4wNzcgMjUuMjMyQzE3NS41OTcgMjQuNzA0IDE3NS4zNTcgMjMuOTc2IDE3NS4zNTcgMjMuMDQ4QzE3NS4zNTcgMjEuODMyIDE3NS44NjEgMjAuODY0IDE3Ni44NjkgMjAuMTQ0QzE3Ny44OTMgMTkuNDA4IDE3OS4yNjkgMTkuMDQgMTgwLjk5NyAxOS4wNEMxODEuODc3IDE5LjA0IDE4Mi43NTcgMTkuMTQ0IDE4My42MzcgMTkuMzUyQzE4NC41MTcgMTkuNTQ0IDE4NS4yMzcgMTkuODA4IDE4NS43OTcgMjAuMTQ0TDE4NC42NDUgMjIuNDI0QzE4My41NTcgMjEuNzg0IDE4Mi4zMzMgMjEuNDY0IDE4MC45NzMgMjEuNDY0QzE4MC4wOTMgMjEuNDY0IDE3OS40MjEgMjEuNiAxNzguOTU3IDIxLjg3MkMxNzguNTA5IDIyLjEyOCAxNzguMjg1IDIyLjQ3MiAxNzguMjg1IDIyLjkwNEMxNzguMjg1IDIzLjM4NCAxNzguNTI1IDIzLjcyOCAxNzkuMDA1IDIzLjkzNkMxNzkuNTAxIDI0LjEyOCAxODAuMjYxIDI0LjMxMiAxODEuMjg1IDI0LjQ4OEMxODIuMzA5IDI0LjY0OCAxODMuMTQ5IDI0LjgzMiAxODMuODA1IDI1LjA0QzE4NC40NjEgMjUuMjQ4IDE4NS4wMjEgMjUuNiAxODUuNDg1IDI2LjA5NkMxODUuOTY1IDI2LjU5MiAxODYuMjA1IDI3LjI5NiAxODYuMjA1IDI4LjIwOEMxODYuMjA1IDI5LjQwOCAxODUuNjg1IDMwLjM2OCAxODQuNjQ1IDMxLjA4OEMxODMuNjA1IDMxLjgwOCAxODIuMTg5IDMyLjE2OCAxODAuMzk3IDMyLjE2OFpNMjA3Ljk3MyAxNC4xOTJWMzJIMjA1LjA5M1YzMC4zNDRDMjA0LjU5NyAzMC45NTIgMjAzLjk4MSAzMS40MDggMjAzLjI0NSAzMS43MTJDMjAyLjUyNSAzMi4wMTYgMjAxLjcyNSAzMi4xNjggMjAwLjg0NSAzMi4xNjhDMTk5LjYxMyAzMi4xNjggMTk4LjUwMSAzMS44OTYgMTk3LjUwOSAzMS4zNTJDMTk2LjUzMyAzMC44MDggMTk1Ljc2NSAzMC4wNCAxOTUuMjA1IDI5LjA0OEMxOTQuNjQ1IDI4LjA0IDE5NC4zNjUgMjYuODg4IDE5NC4zNjUgMjUuNTkyQzE5NC4zNjUgMjQuMjk2IDE5NC42NDUgMjMuMTUyIDE5NS4yMDUgMjIuMTZDMTk1Ljc2NSAyMS4xNjggMTk2LjUzMyAyMC40IDE5Ny41MDkgMTkuODU2QzE5OC41MDEgMTkuMzEyIDE5OS42MTMgMTkuMDQgMjAwLjg0NSAxOS4wNEMyMDEuNjkzIDE5LjA0IDIwMi40NjkgMTkuMTg0IDIwMy4xNzMgMTkuNDcyQzIwMy44NzcgMTkuNzYgMjA0LjQ3NyAyMC4xOTIgMjA0Ljk3MyAyMC43NjhWMTQuMTkySDIwNy45NzNaTTIwMS4yMDUgMjkuNkMyMDEuOTI1IDI5LjYgMjAyLjU3MyAyOS40NCAyMDMuMTQ5IDI5LjEyQzIwMy43MjUgMjguNzg0IDIwNC4xODEgMjguMzEyIDIwNC41MTcgMjcuNzA0QzIwNC44NTMgMjcuMDk2IDIwNS4wMjEgMjYuMzkyIDIwNS4wMjEgMjUuNTkyQzIwNS4wMjEgMjQuNzkyIDIwNC44NTMgMjQuMDg4IDIwNC41MTcgMjMuNDhDMjA0LjE4MSAyMi44NzIgMjAzLjcyNSAyMi40MDggMjAzLjE0OSAyMi4wODhDMjAyLjU3MyAyMS43NTIgMjAxLjkyNSAyMS41ODQgMjAxLjIwNSAyMS41ODRDMjAwLjQ4NSAyMS41ODQgMTk5LjgzNyAyMS43NTIgMTk5LjI2MSAyMi4wODhDMTk4LjY4NSAyMi40MDggMTk4LjIyOSAyMi44NzIgMTk3Ljg5MyAyMy40OEMxOTcuNTU3IDI0LjA4OCAxOTcuMzg5IDI0Ljc5MiAxOTcuMzg5IDI1LjU5MkMxOTcuMzg5IDI2LjM5MiAxOTcuNTU3IDI3LjA5NiAxOTcuODkzIDI3LjcwNEMxOTguMjI5IDI4LjMxMiAxOTguNjg1IDI4Ljc4NCAxOTkuMjYxIDI5LjEyQzE5OS44MzcgMjkuNDQgMjAwLjQ4NSAyOS42IDIwMS4yMDUgMjkuNlpNMjIzLjk0NiAyNS42NjRDMjIzLjk0NiAyNS44NzIgMjIzLjkzIDI2LjE2OCAyMjMuODk4IDI2LjU1MkgyMTMuODQyQzIxNC4wMTggMjcuNDk2IDIxNC40NzQgMjguMjQ4IDIxNS4yMSAyOC44MDhDMjE1Ljk2MiAyOS4zNTIgMjE2Ljg5IDI5LjYyNCAyMTcuOTk0IDI5LjYyNEMyMTkuNDAyIDI5LjYyNCAyMjAuNTYyIDI5LjE2IDIyMS40NzQgMjguMjMyTDIyMy4wODIgMzAuMDhDMjIyLjUwNiAzMC43NjggMjIxLjc3OCAzMS4yODggMjIwLjg5OCAzMS42NEMyMjAuMDE4IDMxLjk5MiAyMTkuMDI2IDMyLjE2OCAyMTcuOTIyIDMyLjE2OEMyMTYuNTE0IDMyLjE2OCAyMTUuMjc0IDMxLjg4OCAyMTQuMjAyIDMxLjMyOEMyMTMuMTMgMzAuNzY4IDIxMi4yOTggMjkuOTkyIDIxMS43MDYgMjlDMjExLjEzIDI3Ljk5MiAyMTAuODQyIDI2Ljg1NiAyMTAuODQyIDI1LjU5MkMyMTAuODQyIDI0LjM0NCAyMTEuMTIyIDIzLjIyNCAyMTEuNjgyIDIyLjIzMkMyMTIuMjU4IDIxLjIyNCAyMTMuMDUgMjAuNDQgMjE0LjA1OCAxOS44OEMyMTUuMDY2IDE5LjMyIDIxNi4yMDIgMTkuMDQgMjE3LjQ2NiAxOS4wNEMyMTguNzE0IDE5LjA0IDIxOS44MjYgMTkuMzIgMjIwLjgwMiAxOS44OEMyMjEuNzk0IDIwLjQyNCAyMjIuNTYyIDIxLjIgMjIzLjEwNiAyMi4yMDhDMjIzLjY2NiAyMy4yIDIyMy45NDYgMjQuMzUyIDIyMy45NDYgMjUuNjY0Wk0yMTcuNDY2IDIxLjQ0QzIxNi41MDYgMjEuNDQgMjE1LjY5IDIxLjcyOCAyMTUuMDE4IDIyLjMwNEMyMTQuMzYyIDIyLjg2NCAyMTMuOTYyIDIzLjYxNiAyMTMuODE4IDI0LjU2SDIyMS4wOUMyMjAuOTYyIDIzLjYzMiAyMjAuNTcgMjIuODggMjE5LjkxNCAyMi4zMDRDMjE5LjI1OCAyMS43MjggMjE4LjQ0MiAyMS40NCAyMTcuNDY2IDIxLjQ0Wk0yMjEuOTc4IDE0LjE0NEwyMTguNzYyIDE3LjQzMkgyMTYuMDI2TDIxMi44MSAxNC4xNDRIMjE1LjI4MkwyMTcuMzk0IDE1LjkyTDIxOS41MDYgMTQuMTQ0SDIyMS45NzhaTTIzNC41MzEgMzEuMzA0QzIzNC4xNzkgMzEuNTkyIDIzMy43NDcgMzEuODA4IDIzMy4yMzUgMzEuOTUyQzIzMi43MzkgMzIuMDk2IDIzMi4yMTEgMzIuMTY4IDIzMS42NTEgMzIuMTY4QzIzMC4yNDMgMzIuMTY4IDIyOS4xNTUgMzEuOCAyMjguMzg3IDMxLjA2NEMyMjcuNjE5IDMwLjMyOCAyMjcuMjM1IDI5LjI1NiAyMjcuMjM1IDI3Ljg0OFYyMS42OEgyMjUuMTIzVjE5LjI4SDIyNy4yMzVWMTYuMzUySDIzMC4yMzVWMTkuMjhIMjMzLjY2N1YyMS42OEgyMzAuMjM1VjI3Ljc3NkMyMzAuMjM1IDI4LjQgMjMwLjM4NyAyOC44OCAyMzAuNjkxIDI5LjIxNkMyMzAuOTk1IDI5LjUzNiAyMzEuNDM1IDI5LjY5NiAyMzIuMDExIDI5LjY5NkMyMzIuNjgzIDI5LjY5NiAyMzMuMjQzIDI5LjUyIDIzMy42OTEgMjkuMTY4TDIzNC41MzEgMzEuMzA0Wk0yNTMuMTc1IDE5LjA0QzI1NC43OTEgMTkuMDQgMjU2LjA3MSAxOS41MTIgMjU3LjAxNSAyMC40NTZDMjU3Ljk1OSAyMS4zODQgMjU4LjQzMSAyMi43ODQgMjU4LjQzMSAyNC42NTZWMzJIMjU1LjQzMVYyNS4wNEMyNTUuNDMxIDIzLjkyIDI1NS4xODMgMjMuMDggMjU0LjY4NyAyMi41MkMyNTQuMTkxIDIxLjk0NCAyNTMuNDc5IDIxLjY1NiAyNTIuNTUxIDIxLjY1NkMyNTEuNTQzIDIxLjY1NiAyNTAuNzM1IDIxLjk5MiAyNTAuMTI3IDIyLjY2NEMyNDkuNTE5IDIzLjMyIDI0OS4yMTUgMjQuMjY0IDI0OS4yMTUgMjUuNDk2VjMySDI0Ni4yMTVWMjUuMDRDMjQ2LjIxNSAyMy45MiAyNDUuOTY3IDIzLjA4IDI0NS40NzEgMjIuNTJDMjQ0Ljk3NSAyMS45NDQgMjQ0LjI2MyAyMS42NTYgMjQzLjMzNSAyMS42NTZDMjQyLjMxMSAyMS42NTYgMjQxLjQ5NSAyMS45ODQgMjQwLjg4NyAyMi42NEMyNDAuMjk1IDIzLjI5NiAyMzkuOTk5IDI0LjI0OCAyMzkuOTk5IDI1LjQ5NlYzMkgyMzYuOTk5VjE5LjE4NEgyMzkuODU1VjIwLjgxNkMyNDAuMzM1IDIwLjI0IDI0MC45MzUgMTkuOCAyNDEuNjU1IDE5LjQ5NkMyNDIuMzc1IDE5LjE5MiAyNDMuMTc1IDE5LjA0IDI0NC4wNTUgMTkuMDRDMjQ1LjAxNSAxOS4wNCAyNDUuODYzIDE5LjIyNCAyNDYuNTk5IDE5LjU5MkMyNDcuMzUxIDE5Ljk0NCAyNDcuOTQzIDIwLjQ3MiAyNDguMzc1IDIxLjE3NkMyNDguOTAzIDIwLjUwNCAyNDkuNTgzIDE5Ljk4NCAyNTAuNDE1IDE5LjYxNkMyNTEuMjQ3IDE5LjIzMiAyNTIuMTY3IDE5LjA0IDI1My4xNzUgMTkuMDRaTTI2Mi4yNjUgMTkuMTg0SDI2NS4yNjVWMzJIMjYyLjI2NVYxOS4xODRaTTI2My43NzcgMTcuMDcyQzI2My4yMzMgMTcuMDcyIDI2Mi43NzcgMTYuOTA0IDI2Mi40MDkgMTYuNTY4QzI2Mi4wNDEgMTYuMjE2IDI2MS44NTcgMTUuNzg0IDI2MS44NTcgMTUuMjcyQzI2MS44NTcgMTQuNzYgMjYyLjA0MSAxNC4zMzYgMjYyLjQwOSAxNEMyNjIuNzc3IDEzLjY0OCAyNjMuMjMzIDEzLjQ3MiAyNjMuNzc3IDEzLjQ3MkMyNjQuMzIxIDEzLjQ3MiAyNjQuNzc3IDEzLjY0IDI2NS4xNDUgMTMuOTc2QzI2NS41MTMgMTQuMjk2IDI2NS42OTcgMTQuNzA0IDI2NS42OTcgMTUuMkMyNjUuNjk3IDE1LjcyOCAyNjUuNTEzIDE2LjE3NiAyNjUuMTQ1IDE2LjU0NEMyNjQuNzkzIDE2Ljg5NiAyNjQuMzM3IDE3LjA3MiAyNjMuNzc3IDE3LjA3MloiIGZpbGw9IiMzRDNEM0QiLz4KPHBhdGggZD0iTTExLjQ3OTQgMzcuMTQwNkMxMy4xNzIgMzcuMDMxNSAxMi41OTQ5IDM3Ljg0NDMgMTIuNTM1MSAzOC40MTA5QzEyLjQxMTkgMzkuNjY3MSAxMS42MTY3IDQwLjQ5NCAxMC45NzYyIDQxLjIwODNDMTAuMjI2NyA0MS45NjE0IDkuMTgxNjUgNDIuMzgwMSA4LjU2NTg1IDQyLjA0MjNDNy43NzQxMiA0MS42MDk1IDguNDk5IDQwLjU1NzMgOC45MTc3NCAzOS45MzFDMTAuODYzNiAzNy4xNTgyIDExLjAzOTYgMzYuODk3OCAxMS40Nzk0IDM3LjE0MDZaIiBmaWxsPSIjMDk5NEQwIi8+CjxwYXRoIGQ9Ik0zMS41MTg4IDI0Ljk4NjVDMzAuODc0OCAyOC4zODU3IDMwLjI4MDIgMzEuNzkxOSAyOS41NzY0IDM1LjE5MTFDMjguOTY0MSAzNy41ODc0IDI4LjMzNzggNDAuMDAxNCAyNy4xMTMyIDQyLjY3MjFDMjYuNTc0OCA0My44NTggMjUuMzUzOCA0NC4zMDE0IDI0LjY4NTIgNDQuMTAwOEMyMy44MzAyIDQzLjg0MDQgMjQuMDA5NiA0Mi40NTA1IDI0LjI2MyA0MS40MTI0QzI0Ljk2NjcgMzguNTIzNCAyNS43MTYyIDM1Ljk4MjkgMjYuMzc0MyAzMy4xNjc4QzI2LjYyMjUgMzIuMzcxNyAyNi44MjU4IDMxLjU2MjMgMjYuOTgzIDMwLjc0MzNDMjcuMDkyMSAzMC4xMTcgMjcuMjA0NyAyOS4zMzU4IDI2LjU5NiAyOC44ODU0QzI1LjkyMzkgMjguMzg1NyAyNS4yMzA2IDI4LjkxIDI0LjY1IDI5LjIzNzNDMjMuODkzNyAyOS42Nzc1IDIzLjE4NiAzMC4xOTY1IDIyLjUzODcgMzAuNzg1NkMyMS4yNzkgMzEuOTQ2OCAyMC4wNzU2IDMzLjE3ODQgMTguODY4NiAzNC4zNzgzQzE4LjA0ODcgMzMuMDMwNiAxNy4zMjAzIDMxLjc3MDggMTcuNDg1NyAzMC4xNTU3QzE5LjI5ODEgMjguNDQ5NCAyMC44NDA2IDI2LjQ3NzQgMjIuMDYwMiAyNC4zMDc0QzIyLjYwOTEgMjMuMzI1NiAyMi42MTYyIDIxLjk0NjMgMjIuMTQxMSAyMS4yNjcxQzIwLjMzOTUgMTguNjgwOCAxOC4yMTc2IDE2LjU5NzcgMTUuODg0NiAxNC41NDk3TDE1Ljk0OCAxNC42Nzk5QzE1Ljk3NjEgMTQuNDcyMyAxNS45MDU4IDE0LjUzOTEgMTUuODA3MiAxNC41OTU0QzE1Ljc0MDQgMTMuNzkzMiAxNS4xNzM4IDEzLjgyMTMgMTQuNzM0IDEzLjQxMzFDMTQuMTQ2MyAxMi44ODg4IDEzLjk4OCAxMi43NTUxIDEyLjk3NDYgMTEuODIyNkMxMi4xNjE3IDExLjA2NjEgMTAuOTcyNCA5Ljc2NDEgMTEuNjg2NyA4Ljk0NDIxQzEyLjMwNiA4LjI0MDQ1IDEzLjgyNjEgOS4yNzQ5OCAxNC42MTc5IDkuOTc1MjNDMTYuMjY0NyAxMS40MjUgMTcuODU1MiAxMi40Mzg0IDE5LjU0NDIgMTMuNzUwOUMyMC45IDE0Ljg4MzEgMjIuNTAxMyAxNS42ODMxIDI0LjIyMDcgMTYuMDg3NEMyNi4yMjMgMTYuNTE2NyAyOC4wOTE0IDE1LjkxMTUgMjguNzAwMiAxMy45NTg1QzI5LjEyMzIgMTIuNTc0NSAyOS4zNTk4IDExLjE0MDMgMjkuNDA0IDkuNjkzNzJDMjkuNDkxOSA3LjI3OTgxIDI5LjQwNCA2LjYwMDY3IDI5LjQwNCA0LjE4Njc2QzI5LjQwNCAzLjM5ODU0IDI5LjMyNjYgMi4wNzU0NiAyOS4zNTgyIDEuNTI2NTNDMjkuMzg5OSAwLjk3NzU5MSAyOS4xNTc3IDAuNjA0NTk2IDI5LjcxMDEgMC40NzA4ODFDMzAuMjYyNiAwLjMzNzE2NSAzMC42Mjg1IDAuNzk0NjEyIDMwLjkyNDEgMS4yNTU1OEMzMS40MDgxIDIuMDQzNTQgMzEuNzMzMiAyLjkxODU3IDMxLjg4MTIgMy44MzEzNkMzMi4xODAzIDUuNDE4MzUgMzIuMDMyNSA1LjAzODMxIDMyLjI4NTkgNi42NDY0MkwzMi40ODI5IDguNjkwODZDMzIuNTU2OCAxMS41MDU5IDMyLjYyNzIgMTAuODgzMSAzMi41MzU3IDEzLjY5MTFDMzIuNTM1NyAxMy44NDk1IDMyLjM5MTUgMTUuODAyNCAzMi4zODc5IDE1Ljk1MzdDMzIuMTgxNSAxOC4wMTU3IDMxLjk3MTUgMjAuMDc4OSAzMS43NTgxIDIyLjE0MzMiIGZpbGw9IiMwOTk0RDAiLz4KPHBhdGggZD0iTTcuMTU0NDIgMzAuOTMzNEM2LjI3NDcxIDMxLjkwNDYgNC43NjE2MiAzMy41MTI3IDMuODcxMzUgMzQuNDUyMkMzLjQyNzk4IDM0LjkyNzMgMy41Njg3MyAzNS40MzQgMy45ODA0NCAzNS41NjA3QzQuMjc2MDIgMzUuNjU1NyA1Ljk2ODU3IDM2LjIxODcgNi4yNjA2NCAzNi4zMTAyQzYuNjEyNTIgMzYuNDE5MyA2Ljc0OTc1IDM2LjM3IDUuODg3NjQgMzcuNTEwMUM0LjQwODYzIDM5LjQyNTcgMi43NzAwNCA0MS4yMTI2IDAuOTg5NDM2IDQyLjg1MTdDMC40MzY5ODEgNDMuMzY1NCAtMC4zODI5MDUgNDQuMTI5IDAuMzQxOTcyIDQ0Ljg1NzRDMC45NjgzMjMgNDUuNDgzOCAxLjcxNzgzIDQ0LjY1NjggMi4yOTQ5MiA0NC4yNTU3QzQuNzU4MSA0Mi41NDkxIDcuNDU3MDQgMzkuMjQ0OSA5LjY0NTc1IDM3LjI2NzNDOS43NjE4NyAzNy4xNjE3IDkuODQ2MzIgMzcuMzA5NSAxMi4wMzE1IDM3LjUxNzFDMTIuMTAxOSAzNy41MTcxIDEyLjU1MjMgMzcuNjA4NiAxMi41MTM2IDM4LjAyMzlDMTIuMzYzNyAzOS4zOTQzIDExLjk4NTUgNDAuNzMgMTEuMzk0NiA0MS45NzU1QzEwLjgxMDUgNDMuMjQ1OCAxMC40MDIzIDQ0LjAxOTkgOS43NDc3OSA0NS4xNzc2QzkuNTI5NjIgNDUuNTY4MiA5LjI5NzM4IDQ2LjAzMjcgOS43NDc3OSA0Ni4zNzc1QzEwLjE5ODIgNDYuNzIyNCAxMC41OTIzIDQ2LjQxOTggMTAuOTQ0MiA0Ni4xNTk0QzExLjk5OTggNDUuMzcxMiAxMi43MDM2IDQ0LjMxMiAxMy4zMDUzIDQzLjE0NzNDMTMuOTczOSA0MS44OTQ2IDE0LjM3ODYgNDAuNDUxOCAxNC45MjA1IDM5LjIwOTdMMTUuMDk2NCAzOC43Mjc2QzE1LjQ0ODMgMzcuNzQ5NCAxNS40ODM1IDM3Ljc3NCAxNS43MjYzIDM3Ljc2MzVDMTYuNDMgMzcuNzM4OCAxNy43NjM3IDM3LjYyNjIgMTguNDUzNCAzNy41MzEyQzE5LjU1MTIgMzcuMzc2NCAxOS45NzcgMzcuMDkxNCAxOS41MDkgMzUuOTMzN0MxOS4yNDUxIDM1LjI4MjcgMTkuMDQxIDM0LjYzNTIgMTguODA1MiAzNC4wNTgxQzE4LjI1MjggMzIuNDExMyAxNy45MjU1IDMxLjk0NjggMTcuNjE5NCAyOS45OTM5QzE3LjQ3MTYgMjcuOTgxMSAxNy43MTA5IDI2LjE5IDE3LjY1NDYgMjQuMzE0NUMxNy41ODEyIDIxLjEzMTIgMTcuMTQ4IDE3Ljk2NjUgMTYuMzYzMiAxNC44ODA1TDE2LjMzNSAxNC43MjIyQzE2LjI4NTggMTQuNDU4MyAxNi4zMzUgMTQuNjggMTYuMjg5MyAxNC40OUMxNi4xNzMyIDEzLjc4NjIgMTUuNTI5MiAxMy4xOTE1IDE0LjgxNDkgMTMuMzQyOEMxNC4xMDA2IDEzLjQ5NDEgMTQuMjQ4NCAxNS4wMjQ4IDE0LjMxNTIgMTUuNTYzMkMxNC40OTEyIDE2Ljk5ODkgMTQuODU3MSAxOC40MjQgMTQuOTkwOCAxOS44NjMyQzE1LjExNzYgMjAuNjQyMiAxNS4xNTg5IDIxLjQzMjggMTUuMTE0IDIyLjIyMDhDMTQuOTgzOCAyMy41MzMzIDE0LjMwMTIgMjQuMjQ0MSAxMi45MzU4IDI0LjQ0ODJDOS44MTExMyAyNC45MTYyIDcuMjA3MiAyMy42MzE5IDQuNjgwNjggMjIuMDYyNUMzLjc1MTcxIDIxLjQ4ODkgMi44NjE0NSAyMC44Mzc5IDEuODkwMjYgMjAuMzQ1M0MxLjQwODE4IDIwLjA5MTkgMC42ODMyOTggMTkuNzA4NCAwLjE5MDY2MyAyMC4zMDY2Qy0wLjI0NTY3MSAyMC44Mjc0IDAuMTQ0OTE4IDIxLjMzNzYgMC41ODEyNTMgMjEuNzE0MUwwLjg0NTE2NCAyMS45MTEyQzMuNTc5MjkgMjMuNzEyOCA1Ljg1OTQ5IDI1LjI2ODEgOC43NjI1MiAyNi45Mzk2QzkuNjkxNDkgMjcuNDc0NCA5LjUwODUxIDI4LjI5MDggOC43NDE0MSAyOS4xNjM1TDcuMTU0NDIgMzAuOTMzNFoiIGZpbGw9IiNGNDg3MzUiLz4KPHBhdGggZD0iTTYxLjM4MzIgMzcuMTI2N0M2MS4zNjIxIDM2LjA5MjEgNjEuMzgzMiAzNi4yMTg4IDYxLjM1ODYgMzUuOTUxNEM2MS4wMzE0IDMzLjEzNjMgNjEuMDg3NyAzMS4wMjUgNjEuMzE5OSAyNi45NjQzQzYxLjQ3NDcgMjQuMTE0IDYxLjcyODEgMjEuMjYzOCA2Mi43Mjc0IDE4LjU0MDJDNjMuMDE5NSAxNy43MzQ0IDYzLjMyMjEgMTYuNjA0OSA2NC4yNTExIDE2LjcyOEM2NS4wNDI4IDE2LjgzMzYgNjQuNTA4IDE4LjI3OTggNjQuMjkzMyAxOS4wNjhDNjMuOTE0MSAyMC40NzA3IDYzLjcxMTkgMjEuOTE1MiA2My42OTE2IDIzLjM2ODFDNjMuNjc0IDI2LjQwODMgNjUuMDY3NSAyNy4zNzI1IDY3Ljg4NiAyNi40MjI0QzY4Ljg2MDcgMjYuMDk1MSA3MC4wOTIzIDI1LjI5OTkgNzEuMDEwNyAyNC43NTQ1QzcyLjA2NjQgMjQuMTMxNiA3My41NDQzIDIzLjM0NjkgNzQuMTk4OCAyMy4yNjk1Qzc0LjUxOSAyMy4yMjczIDc0Ljg2MzkgMjMuMjM0MyA3NC45NzY1IDIzLjU4MjdDNzUuMDE5NSAyMy43NTYgNzUuMDAzIDIzLjkzODcgNzQuOTI5NiAyNC4xMDE1Qzc0Ljg1NjIgMjQuMjY0MiA3NC43MzAyIDI0LjM5NzYgNzQuNTcxOCAyNC40OEM3My41NTg0IDI1LjE4MzggNzIuNTMwOSAyNS44MzEyIDcxLjUwNjkgMjYuNTAzM0M3MC41OTIgMjcuMTAxNSA2OS42MzQ5IDI3LjY0MzQgNjguNzY5MyAyOC4zMDg1QzY3LjAwOTggMjkuNjU5NyA2Ni43NzQxIDMxLjA1NjcgNjguMDY1NSAzMi44NTEzQzY5LjUyOTMgMzQuODY0IDcxLjEwOTMgMzYuODUyMiA3Mi42MTg4IDM4LjgzMzNDNzMuMjI3NiAzOS42MzIxIDczLjc3MyA0MC40MjczIDc0LjM3ODMgNDEuMjM2NkM3NC43MTI1IDQxLjY5MDYgNzUuMDM2MyA0Mi4yNDY1IDc0LjU5NjQgNDIuNjQ0MkM3NC4xNTY2IDQzLjA0MTggNzMuNTg2NSA0Mi41ODA4IDczLjE4ODkgNDIuMjkyM0M3MS43NjAzIDQxLjIzNjYgNzAuNzI1NyAzOS44MjkxIDY5LjU2NDUgMzguNTAyNUM2OC4zMDEzIDM3LjA0NTcgNjcuMTAxMyAzNS41NDMyIDY1LjUzOSAzNC4zNzE0QzY1LjE4NzEgMzQuMDkzNCA2NC42OTggMzMuNzE2OSA2NC4yNTQ2IDM0LjAxOTVDNjMuNzU0OSAzNC4zNDMzIDYzLjY1OTkgMzUuMjMgNjMuNzA1NyAzNS44NDU4QzYzLjgzNTkgMzcuNjA1MiA2NC40MDk0IDM5LjI4MDIgNjQuNzYxMyA0MC45ODY4QzY1LjAyMTcgNDIuMTcyNiA2NS4yNjQ1IDQyLjY0NzcgNjQuNTI1NiA0Mi44OTRDNjMuMzI1NiA0My4yNDU5IDYyLjk4MDggNDIuMDYzNiA2Mi42NTM1IDQxLjEzNDZDNjIuNTUxNSA0MC44NDYxIDYyLjE5OTYgMzkuNjk1NCA2Mi4xMDQ2IDM5LjQwMzNMNjEuMzgzMiAzNy4xMjY3WiIgZmlsbD0iI0Q1QzQwNSIvPgo8cGF0aCBkPSJNNDMuNDY4OCAyMy4zMTUyQzQzLjU5OSAyNS4xODcyIDQyLjQ0NDkgMjkuMDMzMyA0MS45NjYzIDMwLjc5NjJDNDEuNjc0MiAzMS44NTE5IDQyLjQ1MTkgMzIuMzQxIDQzLjUwNCAzMi4zNTE1QzQzLjg5NDYgMzIuMzUxNSA0NC40MDg0IDMyLjM4MzIgNDQuNzk4OSAzMi4zNzYyQzQ1Ljg3MjIgMzIuMzc2MiA0Ny4wOTMyIDMyLjM3NjIgNDcuMDkzMiAzMi4zNzYyQzQ3LjQ2NjIgMzMuNDEwNyA0Ny43OTcgMzQuODM5MyA0OC4yOTY3IDM1Ljk0NzhDNDguMzcwNiAzNi4yMzI4IDQ4LjQ4NjcgMzYuNDc1NiA0OC42MjM5IDM2Ljg2NjJDNDguNzM3IDM3LjEwMjEgNDguODM2OSAzNy4zNDQxIDQ4LjkyMyAzNy41OTExQzQ5LjQ0NzMgMzguNjQ2NyA0OS45NTQgMzkuNzAyMyA1MC41MDMgNDAuNzIyOEM1MS4wNTE5IDQxLjc0MzMgNTEuNjg4OCA0Mi43NTMyIDUyLjY4ODIgNDMuNDYwNUM1Mi44Nzk0IDQzLjYwNjcgNTMuMTE1OSA0My42ODEyIDUzLjM1NjQgNDMuNjcwOUM1My41OTY5IDQzLjY2MDYgNTMuODI2MiA0My41NjYyIDU0LjAwNDIgNDMuNDA0MUM1NC40NDA1IDQzLjEwMTUgNTQuMjExOCA0Mi43MDA0IDU0LjA2NzUgNDIuMzQ4NUM1My44MjEyIDQxLjc0MzMgNTMuNTMyNyA0MS4xNTU2IDUzLjIzNzEgNDAuNTcxNUM1Mi40NTkxIDM5LjEzNDkgNTEuNzkyMSAzNy42NDA5IDUxLjI0MTkgMzYuMTAyNkw1MC41MzgyIDMzLjk0NTVDNTAuNDMyNiAzMy42NDAyIDUwLjM1NiAzMy4zMjU3IDUwLjMwOTQgMzMuMDA2TDUwLjE1NDYgMzEuOTUwNEM1MC43NDUgMzEuNzQ4NyA1MS4zNDk1IDMxLjU5MTEgNTEuOTYzMyAzMS40Nzg5QzUyLjYxNzggMzEuMzMxMSA1My4yMTk1IDMxLjAwMzggNTMuMzQ2MiAzMS4wOTE4QzUzLjc0NDEgMzEuNDM0NCA1NC4wOTg2IDMxLjgyNDMgNTQuNDAxOCAzMi4yNTNINTQuNDE5NEM1NC43NzEzIDMyLjY0MDEgNTQuNjIzNSAzMi40ODg4IDU0LjgyMDYgMzIuNzM1MUw1NS4wMjExIDMyLjk3NzlDNTUuMTE2MSAzMy4wNzI5IDU1LjE2ODkgMzMuMTY0NCA1NS4yNjA0IDMzLjI1OTRWMzMuMjM4M0w1NS40NzUxIDMzLjQ2TDU2LjQxNDYgMzQuNDg3NEM1OC41Nzg3IDM2Ljc4NTIgNTkuMzU2MyAzNy4zOTc1IDYxLjY5MjggMzkuMjg3MUM2MS45NjM4IDM5LjUwNTMgNjIuMjQ1MyAzOS43MDU5IDYyLjUxOTcgMzkuOTE3QzYyLjc1ODYgNDAuMDYxMSA2My4wMTIyIDQwLjE3OTEgNjMuMjc2MyA0MC4yNjg5QzYzLjUwODUgNDAuMzUzMyA2NC41MzYgNDAuNzM2OSA2NC45NzI0IDQwLjM0OThDNjUuMjc1IDQwLjA4OTQgNjUuMTUxOCAzOS43NzYyIDY0Ljk1MTMgMzkuNTUxQzY0LjI2NjQgMzguODE4NyA2My41MjY1IDM4LjE0IDYyLjczNzkgMzcuNTIwN0M2Mi4wNDczIDM2Ljk3NDQgNjEuMzkwNSAzNi4zODY5IDYwLjc3MDkgMzUuNzYxM0M1OS4zMjgyIDM0LjI2NTggNTcuNTAxOSAzMS42ODY1IDU2LjQwNCAyOS45MjcxQzU2LjM3OTQgMjkuODg4MyA1Ny40NTk3IDI5LjQwNjMgNTguMTI0NyAyOC45NjI5QzYwLjE1NTEgMjcuNTg3IDYwLjQxOSAyNy43NzcxIDU4Ljc5NjggMjYuMDUyOEM1Ny41NzkzIDI0Ljc1NzkgNTYuMTE1NSAyMy4zMzk4IDU0Ljk1NzggMjEuOTg4NkM1Mi4zMTE2IDE4Ljg5OTEgNTEuODgyMyAxOC45MjcyIDUzLjUwOCAxNy4yNTU4QzU1Ljc5NTMgMTQuOTA4NyA1OC40ODcyIDEzLjAzMzIgNjAuODYyNCAxMC43ODExQzYxLjMyODUgMTAuMzI5NiA2MS43NjAxIDkuODQzNzkgNjIuMTUzOCA5LjMyNzg2QzYyLjQ2MzQgOC45NDA3OSA2My4xMjUgOC4zMjg1MSA2Mi41NjkgNy43MzM4M0M2Mi4wOTA1IDcuMjE2NTYgNjEuNDcxMSA3LjQzODI1IDYwLjk5OTYgNy43NjkwMkM1OS42NjI1IDguNzE1NTggNTguNTM2NCA5Ljc1MDEyIDU3LjM0NzEgMTAuNzgxMUM1NS4xODY1IDEyLjY0MjYgNTIuOTA2MyAxNC4yMDE0IDQ5Ljk1NzUgMTQuNDg2NUM0Ny44MTQ2IDE0LjY5MDUgNDYuNjYzOSAxMy42Mzg0IDQ2LjIwMyAxMS41MTY2QzQ1Ljc1MjYgOS40NDc1IDQ2LjAyIDcuMzQ2NzYgNDYuMTM5NiA1LjI3MDY1QzQ2LjMwMTUgMy43ODU3MSA0Ni40IDIuNjkxMzUgNDYuNDkxNSAxLjMzNjYxQzQ2LjUzMDIgMC43NjY1NTggNDYuNDkxNSAwLjExMjA1NiA0NS43ODc3IDAuMDA2NDkxNDdDNDUuMzEyNyAtMC4wNjM4ODUgNDQuODA2IDAuNDQ5ODYzIDQ0LjU3NzMgMC45NzA2NDlDNDMuOTU0NCAyLjM5OTI5IDQzLjg3MzUgNC4wMTc5NSA0My43MTE2IDUuNTQ1MTJDNDMuMjQzNiAxMC4zMDk2IDQyLjkzMDUgMTYuOTg4MyA0My41MTExIDIxLjczMTdMNDMuNDY4OCAyMy4zMTUyWiIgZmlsbD0iI0JGNkJDNiIvPgo8cGF0aCBkPSJNMTcuNTk0NiAyOS45OTM4QzE3LjQ0NjggMjcuOTgxMSAxNy42MTIyIDI2LjE5NyAxNy42Mjk4IDI0LjMxNDVMMTcuNTk0NiAyOS45OTM4WiIgZmlsbD0iI0YzODczNyIvPgo8cGF0aCBkPSJNNDQuNzEwNiAzOC45MDM1QzQzLjI0MzIgMzYuMjI5MiA0Mi4yNDc0IDM0LjYgNDEuMDEyMyAzMS43MjUxQzQwLjgxNzIgMzEuMjQ3NCA0MC43NDgyIDMwLjcyNzYgNDAuODExNyAzMC4yMTU1QzQxLjEyMTQgMjguMTkyMiA0Mi4zMTc4IDI2LjUyNzggNDMuMDUzMiAyNS4yODkyQzQzLjc3NDYgMjMuOTMwOSA0NC41NTkzIDIyLjcyMDQgNDUuMjU5NSAyMS4zOTAzQzQ1LjU1ODYgMjAuODE2OCA0NS43NjYyIDIwLjI1MDIgNDUuNTQxIDE5Ljg0MjFDNDUuMzE1OCAxOS40MzM5IDQ0Ljg2MTkgMTkuNTI1NCA0NC42NTQzIDE5Ljg4MDhDNDQuNDUyNCAyMC4yMjc0IDQ0LjIyOTEgMjAuNTYxMiA0My45ODU3IDIwLjg4MDFDNDMuMDQyNyAyMi4yMTAyIDQxLjk4NyAyMy4yNjIzIDQwLjkyMDggMjQuNTA0NUMzOS4wODQgMjYuNTI3OCAzNS42NjcyIDI2LjI0MjggMzMuNjk2NyAyNC4zMDA0TDMxLjMxNzkgMjEuOTExMUMzMC42OTE2IDIxLjI2NzIgMzAuMTQyNyAyMC42NjkgMjkuNjUzNSAyMC4xMjM2QzI5LjQ4ODEgMTkuOTM3MSAyOS4wNjk0IDIwLjAwMDQgMjguODY4OCAyMC4zNDUyQzI4LjU4NzMgMjAuODI3MyAyOS4wMDI2IDIxLjQ0NjYgMjkuMzEyMiAyMS44NTQ4QzMwLjA4MjggMjIuODc1MyAzMC44NzQ2IDIzLjkzMDkgMzEuNjY5OCAyNC45NDA4QzMyLjgyMzkgMjYuMzE5MyAzMy44NjQxIDI3Ljc4OTEgMzQuNzgwNSAyOS4zMzU4QzM1LjA2MjEgMjkuODA4NyAzNS4yMzM2IDMwLjMzOSAzNS4yODIzIDMwLjg4NzJDMzUuMzMxMSAzMS40MzU0IDM1LjI1NTggMzEuOTg3NiAzNS4wNjIgMzIuNTAyOEMzNC41OTc1IDMzLjgyMjMgMzQuMDQxNSAzNS4xMTAyIDMzLjQ4OTEgMzYuMzk4MUMzMi42MjY5IDM4LjQxMDkgMzEuNzAxNSA0MC4zOTkgMzEuMTE3NCA0Mi41MTc0QzMxLjAxNTMgNDIuODkzOSAzMC45MjM4IDQzLjMxMjYgMzEuMzA3NCA0My42MTE3QzMxLjc2NDggNDMuOTYzNiAzMi4xNDg0IDQzLjY2NDUgMzIuNDg5NyA0My40MDQxQzMzLjE1NjUgNDIuODM1NyAzMy43MDczIDQyLjE0MzkgMzQuMTExOSA0MS4zNjY3QzM1LjEwNDIgMzkuNjY3MSAzNS45OTQ1IDM3LjkwNzcgMzcuMDcxMiAzNi4yNjA5QzM4LjE0OCAzNC42MTQxIDM4Ljc2NzMgMzQuNjQ5MyAzOS45MjUgMzYuMTk3NUM0MS4wODI3IDM3Ljc0NTggNDIuMDYwOSAzOS4yOTc2IDQzLjExNjYgNDAuODU2NUM0My42MzQ3IDQxLjcyMjIgNDQuMzA2IDQyLjQ4NjUgNDUuMDk3NyA0My4xMTJDNDUuMzk2OCA0My4zMjMyIDQ1Ljc0NTEgNDMuNDYzOSA0Ni4wNjg4IDQzLjI0OTNDNDYuMTk4NCA0My4xMjE2IDQ2LjI5MTYgNDIuOTYxNyA0Ni4zMzg2IDQyLjc4NkM0Ni4zODU2IDQyLjYxMDMgNDYuMzg0OCA0Mi40MjUyIDQ2LjMzNjMgNDIuMjQ5OUM0Ni4yMjAyIDQxLjc3NDkgNDUuNjkyMyA0MC45MjMzIDQ1LjQxNDMgNDAuMjc5NEw0NC43MTA2IDM4LjkwMzVaIiBmaWxsPSIjOUZCRjA0Ii8+CjxwYXRoIGQ9Ik02Ni44NDAzIDI1LjUxMUM2OC4wMjU4IDI1LjUxMSA2OC45ODY4IDI0LjU1IDY4Ljk4NjggMjMuMzY0NUM2OC45ODY4IDIyLjE3OSA2OC4wMjU4IDIxLjIxOCA2Ni44NDAzIDIxLjIxOEM2NS42NTQ5IDIxLjIxOCA2NC42OTM4IDIyLjE3OSA2NC42OTM4IDIzLjM2NDVDNjQuNjkzOCAyNC41NSA2NS42NTQ5IDI1LjUxMSA2Ni44NDAzIDI1LjUxMVoiIGZpbGw9IiNENUM0MDUiLz4KPHBhdGggZD0iTTM3LjU2MDUgMjQuODAwMkMzOC45NTIgMjQuODAwMiA0MC4wOCAyMy42NzIyIDQwLjA4IDIyLjI4MDdDNDAuMDggMjAuODg5MiAzOC45NTIgMTkuNzYxMiAzNy41NjA1IDE5Ljc2MTJDMzYuMTY5IDE5Ljc2MTIgMzUuMDQxIDIwLjg4OTIgMzUuMDQxIDIyLjI4MDdDMzUuMDQxIDIzLjY3MjIgMzYuMTY5IDI0LjgwMDIgMzcuNTYwNSAyNC44MDAyWiIgZmlsbD0iIzlGQkYwNCIvPgo8cGF0aCBkPSJNNTAuOTI0OCAxMi41NjUzQzUyLjg0NDkgMTIuNTY1MyA1NC40MDE0IDExLjAwODcgNTQuNDAxNCA5LjA4ODY2QzU0LjQwMTQgNy4xNjg1OSA1Mi44NDQ5IDUuNjEyMDYgNTAuOTI0OCA1LjYxMjA2QzQ5LjAwNDggNS42MTIwNiA0Ny40NDgyIDcuMTY4NTkgNDcuNDQ4MiA5LjA4ODY2QzQ3LjQ0ODIgMTEuMDA4NyA0OS4wMDQ4IDEyLjU2NTMgNTAuOTI0OCAxMi41NjUzWiIgZmlsbD0iI0JGNkJDNiIvPgo8cGF0aCBkPSJNMjQuMTAwOCAxNC4wNTM2QzI2LjA2MTcgMTQuMDUzNiAyNy42NTEzIDEyLjQ2NCAyNy42NTEzIDEwLjUwMzFDMjcuNjUxMyA4LjU0MjI1IDI2LjA2MTcgNi45NTI2NCAyNC4xMDA4IDYuOTUyNjRDMjIuMTM5OSA2Ljk1MjY0IDIwLjU1MDMgOC41NDIyNSAyMC41NTAzIDEwLjUwMzFDMjAuNTUwMyAxMi40NjQgMjIuMTM5OSAxNC4wNTM2IDI0LjEwMDggMTQuMDUzNloiIGZpbGw9IiMwOTk0RDAiLz4KPHBhdGggZD0iTTExLjM0MjEgMjMuMjk0MUMxMi43NzgzIDIzLjI5NDEgMTMuOTQyNSAyMi4xMjk4IDEzLjk0MjUgMjAuNjkzN0MxMy45NDI1IDE5LjI1NzUgMTIuNzc4MyAxOC4wOTMzIDExLjM0MjEgMTguMDkzM0M5LjkwNTk0IDE4LjA5MzMgOC43NDE3IDE5LjI1NzUgOC43NDE3IDIwLjY5MzdDOC43NDE3IDIyLjEyOTggOS45MDU5NCAyMy4yOTQxIDExLjM0MjEgMjMuMjk0MVoiIGZpbGw9IiNGNDg3MzUiLz4KPC9zdmc+Cg==",
      "logoExtension": "svg",
      "sender": {
        "company": "Cestuj s dětmi.cz",
        "address": "Svatopluka Čecha 59",
        "zip": "460 51",
        "city": "Jablonec nad Nisou",
        "country": "Česká republika",
      },
      "client": {
        "company": "Monium",
        "address": "Přípotoční 957/11",
        "zip": "101 00",
        "city": "Praha",
        "country": "Česká republika",
      },
      "invoiceNumber": "2020.0001",
      "invoiceDate": `${today.getDay()}.${today.getMonth()+1}.${today.getFullYear()}`,
      "products": [{
        "quantity": "1",
        "description": `Aparthotel Jablonec - druh zapisu: Premium Gold`,
        "tax": 21,
        "price": 1490,
      }],
      "bottomNotice": "Zdá se Vám, že je ve vyúčtování chyba? Napište nám na email kontakt@cestujsdetmi.cz"
    };

    try {

      const result = await easyinvoice.createInvoice(data);
      console.log(result);
      await fs.writeFileSync("invoice.pdf", result.pdf, "base64");
      return "pdf created"
    } catch (err) {
      console.log(err);
      return err
    }

  },
  createFromDocx: (data) => {

    function replaceErrors(key, value) {
      if (value instanceof Error) {
        return Object.getOwnPropertyNames(value).reduce(function(error, key) {
          error[key] = value[key];
          return error;
        }, {});
      }
      return value;
    }

    function errorHandler(error) {
      console.log(JSON.stringify({error: error}, replaceErrors));

      if (error.properties && error.properties.errors instanceof Array) {
        const errorMessages = error.properties.errors.map(function (error) {
          return error.properties.explanation;
        }).join("\n");
        console.log('errorMessages', errorMessages);
        // errorMessages is a humanly readable message looking like this :
        // 'The tag beginning with "foobar" is unopened'
      }
      throw error;
    }


    const content = fs.readFileSync(path.resolve(__dirname, "invoice_template.docx"), "binary")
    const zip = new PizZip(content);
    let doc;
    try {
      doc = new Docxtemplater(zip);
    } catch (err) {
      errorHandler(err)
    }
    doc.setData({
      InvoiceDate: new Date(),
      InvoiceNumb: Math.floor(Math.random() * 10000),
      CustomNumber: "Martin Foldyna",
      CompanyName: "Monium",
      AddressLine1: "Přípotoční 957/11",
      City: "Praha",
      State: "Česko",
      Zip: "101 00",
      Country: "Česká republika",
      CustomerPhone: "+420725811823",
      CustomerId: v4(),
      Items: [
        {
          Item_Qty: "1",
          Item_Number: v4(),
          Item_Description: "ApartHotel Jablonec - druh zápisu: Premium Gold",
          Item_Price: "1 490,-",
        },
        {
          Item_Qty: "1",
          Item_Number: v4(),
          Item_Description: "Restaurant 59 - druh zápisu: Premium Gold",
          Item_Price: "1 490,-",
        },
      ],
      TotalEx: "2 980,-",
      SalesTax: "25%",
      TotalPrice: "3 725,-",
      defaultStyle: {
        // font: "Helvetica"
      }
    });
    try {
      doc.render()
    } catch (err) {
      errorHandler(err)
    }
    const buf = doc.getZip().generate({type: "nodebuffer"})
    const file = fs.readFileSync(path.resolve(__dirname, "invoice_template.docx"))

    libre.convert(file, ".pdf", undefined, (err, done) => {
      if (err) {
        console.log(`Err while converting file: ${err}`)
      }

      fs.writeFileSync( "example.pdf", done);
    })
  }
};
